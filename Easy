175. Combine Two Tables

select
    p.firstname,
    p.lastname,
    a.city,
    a.state
from Person p
left join Address a on p.personId=a.personId

181. Employees Earning More Than Their Managers

select
    e1.name Employee
from Employee e1
join Employee e2 on e1.managerid=e2.id
where e1.salary>e2.salary


182. Duplicate Emails

select
    email as Email
from Person
group by email
having count(email) >1

183. Customers Who Never Order

select
    c.name Customers
from customers c
left join Orders o on c.id=o.customerId
where o.customerId is null

196. Delete Duplicate Emails

delete
    p1
from Person p1
join person p2 on p1.email=p2.email and p1.id>p2.id

197. Rising Temperature

select
    w2.Id
from weather w1
cross join weather w2
where datediff(w2.recorddate,w1.recorddate)=1
and w2.temperature>w1.temperature

511. Game Play Analysis I

select
    player_id,
    min(event_date) first_login
from Activity
group by player_id

577. Employee Bonus

select
    e.name,
    b.bonus
from Employee e
left join Bonus b on e.empId=b.empId
where b.bonus <1000 or b.bonus is null

584. Find Customer Referee

select 
    name
from Customer
where referee_id <>2 or referee_id is null

586. Customer Placing the Largest Number of Orders

select
    customer_number 
from Orders 
group by customer_number 
having count(order_number) = 
(
    select 
        max(order_num) 
    from 
        (
            select 
                count(order_number) as order_num 
            from Orders 
            group by customer_number
        ) as Order_nums
)

595. Big Countries

select
    name,
    population,
    area
from World
where area>=3000000
or population >=25000000

596. Classes With at Least 5 Students

select
    class
from Courses
group by class
having count(student) >=5

607. Sales Person

select
    s.name
from SalesPerson s
where s.name not in
(
    select
        s.name
    from SalesPerson s
    left join Orders o on s.sales_id=o.sales_id
    left join Company c on o.com_id=c.com_id
    where c.name='Red'
)

610. Triangle Judgement

Table: Triangle

select 
    x,
    y,
    z,
    case
        when x+z>y and x+y>z and z+y>x then 'Yes'
        else 'No' 
    end as triangle
from Triangle

619. Biggest Single Number

select
    max(num) num
from
(
    select
        num
    from mynumbers
    group by num
    having count(num) <2
) count_num

620. Not Boring Movies

select
    *
from Cinema
where description <> 'boring'
and id%2 <> 0
order by rating desc

627. Swap Salary

SOLUTION:

update salary
set sex=
case
    when sex='m' then 'f'
    else 'm'
end

1050. Actors and Directors Who Cooperated At Least Three Times

select
    actor_id,
    director_id
from actordirector
group by actor_id,director_id
having count(timestamp) >=3
